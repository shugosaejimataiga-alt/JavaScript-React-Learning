
## 1.基本の書き方（最小）

まず「考え方だけ」を見ます。

localStorage.setItem("key", "value");

意味はこれだけです。↓

"key"：名前（ラベル）
"value"：保存する文字列

⚠️ 重要
localStorageに保存できるのは 文字列だけ

だから、配列やオブジェクトは
👉 JSON文字列に変換してから保存 します。

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

## 1-2.練習問題

次のうち、localStorageに直接保存できるものはどれですか？

A. "hello"
B. ["A", "B"]
C. { name: "taro" }

👉 1つだけ答えてください。


解答：A

正解です。👍


理由はこれだけです。

localStorageに保存できるのは 文字列のみ
配列やオブジェクトは そのままでは保存できない

つまり：

"hello" → そのまま保存できる

["A", "B"] → ❌

{ name: "taro" } → ❌

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

## 2-1.基本の書き方（続き）

では、配列を保存する正しい形を見ます。

// 保存↓

localStorage.setItem(
  "todos",
  JSON.stringify(["散歩", "読書"])
);


ここでやっていることは 変換だけ です。

JSON.stringify(...)
→ 配列 → 文字列 に変換

保存された中身は、実際にはこうなっています。

["散歩","読書"]



取り出すとき↓

const todos = JSON.parse(
  localStorage.getItem("todos")
);


getItem：文字列を取り出す

JSON.parse：文字列 → 配列 に戻す

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

## 2-2.確認問題

次の処理で、todos の中身は何になりますか？

const todos = JSON.parse(
  localStorage.getItem("todos") || "[]"
);

👉 「なぜ || "[]" が必要か」 を言葉で答えてください。


解答：todosが空白であるとき、エラーになるから。空白は文字列ではないから


なぜ || "[]" が必要か

👉 localStorageに何も保存されていない場合、getItem は null を返すから


重要ポイント：

localStorage.getItem("todos")

データがある → 文字列
データがない → null

JSON.parse(null)

👉 エラーになる

なので、

localStorage.getItem("todos") || "[]"

はこういう意味です。

データがある → その文字列を使う
データがない（null） → "[]" を使う

結果として：

常に JSON.parse に「正しいJSON文字列」が渡る
todos は 必ず配列になる

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

状態（配列）はメモリ上にあり、
永続化とはそれを「文字列として外に保存し、必要なときに戻す」こと

構造はこれだけです。

配列（状態）
  ↓ JSON.stringify
文字列
  ↓ localStorage
保存
  ↓ 取得
文字列
  ↓ JSON.parse
配列（状態に復元）

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

🟦 Day32｜データ永続化の意味（完全まとめ）

■ 今日のテーマ

データ永続化とは何か

👉 リロードしても、アプリの状態を失わないようにすること



■ なぜ状態は消えるのか（最初の疑問）

疑問
なぜ配列やオブジェクトはリロードすると消えるのか？

答え
JavaScriptの状態は メモリ（RAM）上 にあり、
リロード＝ページを読み直すことで メモリが初期化される から。

👉 自分が消しているのではなく、ブラウザの仕様



■ 「メモリの外」とは何か

疑問
メモリの外とは何を指すのか？

答え
👉 ブラウザが管理する保存領域（ディスク側）

localStorage など

ページを閉じても・リロードしても消えない



■ localStorage は何に使われるのか

疑問
localStorageは実際に何のために使われる？

答え
👉 アプリを「続きから再開」するため

具体例：

ToDoの保存
入力途中フォームの復元
ダークモードなどの設定保持

👉 ユーザー体験を壊さないための仕組み



■ localStorage の制限（重要）

保存できるのは 文字列のみ

配列・オブジェクトはそのまま保存できない



■ JSON の役割

JSON.stringify(配列)

👉 配列 → 文字列（保存用）


JSON.parse(文字列)

👉 文字列 → 配列（状態復元）



■ なぜ || "[]" が必要か

疑問
なぜこう書くのか？

JSON.parse(
  localStorage.getItem("todos") || "[]"
);


答え

データがない場合、getItem は null を返す

JSON.parse(null) は エラー

"[]" を使うことで 必ず配列として復元できる



■ localStorageは状態か？

答え（核心）

👉 いいえ

state（配列）＝ 今の状態・画面の本体

localStorage ＝ 状態の保存箱（バックアップ）



■ Reactとの関係（先取り理解）

疑問
なぜReactではlocalStorageを直接操作しないのか？

答え

localStorageを変えても 画面は変わらない

stateを変えると 自動で再描画される

👉 主役は常に state
localStorageは補助



✅ Day32の一文まとめ（最重要）

状態はメモリ上にあり、
永続化とはそれを文字列にして保存し、
必要なときに状態として復元すること